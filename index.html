<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gerador Minecraft – Resource Pack & Datapack</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<style>
body {
  font-family: Arial, sans-serif;
  background: #ffffff;
  color: #000000;
  padding: 20px;
  max-width: 520px;
  margin: 0 auto;
}
h1 { font-size: 22px; margin-bottom: 10px; }
.card {
  background: #e0e0e0;
  border-radius: 8px;
  padding: 14px;
  margin-bottom: 14px;
}
label { font-weight: bold; margin-top: 10px; display: block; }
input, select, textarea, button {
  width: 100%;
  margin-top: 6px;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #aaa;
}
button { background: #cfcfcf; cursor: pointer; font-weight: bold; }
.item { border: 1px solid #999; padding: 12px; margin-top: 12px; border-radius: 6px; }
.small { font-size: 12px; opacity: 0.8; }
</style>
</head>
<body>

<h1>Gerador Minecraft</h1>

<div style="display:flex; gap:12px; align-items:center; margin-bottom:12px;">
  <button onclick="setPage('resource')" style="flex:1">Resource Pack</button>
  <button onclick="setPage('datapack')" style="flex:1">Datapack</button>
  <select id="savedProjects" onchange="loadProject()" style="flex:1; background:transparent; border:none; border-bottom:1px solid #aaa; border-radius:0; padding:6px;">
    <option value="">Projetos salvos</option>
  </select>
</div>

<div class="card" id="pageTitle"></div>

<div class="card">
  <label>Projetos salvos</label>
  <select id="savedProjects" onchange="loadProject()"></select>
  <button onclick="newProject()">Novo projeto</button>
</div>

<div class="card">
  <label>Nome do projeto</label>
  <input id="projectName" placeholder="Meu pack" />

  <label>Descrição</label>
  <textarea id="projectDesc"></textarea>
</div>

<div class="card">
  <h3>Itens / Blocos</h3>
  <div id="items"></div>
  <button onclick="addItem()">Adicionar</button>
</div>

<button onclick="exportPack()">Exportar</button>

<script>
const terracotaAndTiles = [
  "minecraft:white_terracotta","minecraft:orange_terracotta","minecraft:magenta_terracotta",
  "minecraft:light_blue_terracotta","minecraft:yellow_terracotta","minecraft:lime_terracotta",
  "minecraft:pink_terracotta","minecraft:gray_terracotta","minecraft:light_gray_terracotta",
  "minecraft:cyan_terracotta","minecraft:purple_terracotta","minecraft:blue_terracotta",
  "minecraft:brown_terracotta","minecraft:green_terracotta","minecraft:red_terracotta",
  "minecraft:black_terracotta",
  "minecraft:terracotta","minecraft:bricks","minecraft:stone_bricks",
  "minecraft:deepslate_tiles","minecraft:quartz_bricks"
];

let currentId = null;
let currentPage = 'resource';

function setPage(page) {
  currentPage = page;
  document.getElementById('mode').value = page;
  document.getElementById('items').innerHTML = '';
  document.getElementById('pageTitle').innerHTML = page === 'resource'
    ? '<strong>Modo Resource Pack</strong><br><span class="small">Substituição de terracotas e azulejos</span>'
    : '<strong>Modo Datapack</strong><br><span class="small">Blocos customizados infinitos</span>';
  saveProject();
}

function addItem() {
  const mode = document.getElementById('mode').value;
  const div = document.createElement('div');
  div.className = 'item';

  if (mode === 'resource') {
    div.innerHTML = `
      <label>Nome no jogo (PT-BR)</label>
      <input class="itemName" />

      <label>Substituir bloco</label>
      <select class="target">
        ${terracotaAndTiles.map(v => `<option>${v}</option>`).join('')}
      </select>

      <label>Nome da textura</label>
      <input class="texName" />

      <label>Textura PNG (256x256)</label>
      <input type="file" class="image" accept="image/png" />
    `;
  } else {
    div.innerHTML = `
      <label>Nome do bloco customizado</label>
      <input class="itemName" />

      <label>ID interno (ex: azulejo_moderno)</label>
      <input class="texName" />

      <label>Textura PNG (256x256)</label>
      <input type="file" class="image" accept="image/png" />

      <p class="small">Esse bloco será um bloco customizado via datapack (entidade + modelo)</p>
    `;
  }

  document.getElementById('items').appendChild(div);
  saveProject();
}

function saveProject() {
  const data = collectData();
  if (!currentId) currentId = Date.now().toString();
  localStorage.setItem('project_' + currentId, JSON.stringify(data));
  refreshProjects();
}

function loadProject() {
  const id = document.getElementById('savedProjects').value;
  if (!id) return;
  currentId = id;
  const data = JSON.parse(localStorage.getItem('project_' + id));

  document.getElementById('mode').value = data.mode;
  document.getElementById('projectName').value = data.name;
  document.getElementById('projectDesc').value = data.desc;
  document.getElementById('items').innerHTML = '';

  data.items.forEach(i => {
    addItem();
    const el = document.querySelectorAll('.item');
    const last = el[el.length - 1];
    last.querySelector('.itemName').value = i.name;
    last.querySelector('.texName').value = i.tex;
    if (i.target && last.querySelector('.target')) last.querySelector('.target').value = i.target;
  });
}

function newProject() {
  currentId = null;
  document.getElementById('items').innerHTML = '';
  document.getElementById('projectName').value = '';
  document.getElementById('projectDesc').value = '';
}

function refreshProjects() {
  const sel = document.getElementById('savedProjects');
  sel.innerHTML = '<option value="">— selecionar —</option>';
  Object.keys(localStorage)
    .filter(k => k.startsWith('project_'))
    .forEach(k => {
      const data = JSON.parse(localStorage.getItem(k));
      const opt = document.createElement('option');
      opt.value = k.replace('project_', '');
      opt.textContent = data.name || '(sem nome)';
      sel.appendChild(opt);
    });
}

function collectData() {
  return {
    mode: document.getElementById('mode').value,
    name: document.getElementById('projectName').value,
    desc: document.getElementById('projectDesc').value,
    items: [...document.querySelectorAll('.item')].map(el => ({
      name: el.querySelector('.itemName')?.value,
      tex: el.querySelector('.texName')?.value,
      target: el.querySelector('.target')?.value || null
    }))
  };
}

function exportPack() {
  alert('Exportação completa (ZIP) é o próximo passo. Estrutura de projetos e edição pronta.');
}

refreshProjects();
</script>

</body>
</html>
