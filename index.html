<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Gerador Minecraft – Importar Texturas</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f2f2f2; padding:20px }
    h1,h2 { margin-top:0 }
    .box { background:#fff; padding:15px; border-radius:8px; margin-bottom:20px }
    input, button { padding:8px; margin-top:6px; width:100% }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(120px,1fr)); gap:12px; margin-top:15px }
    .item { border:1px solid #ccc; border-radius:6px; padding:8px; text-align:center; background:#fafafa; cursor:pointer }
    .item img { width:64px; height:64px; image-rendering: pixelated }
    .item input { width:100%; margin-top:4px }
    .item.selected { outline:3px solid #4caf50 }
  </style>
</head>
<body>

<h1>Gerador de Projeto Minecraft</h1>

<div class="box">
  <h2>Importar Texture Pack (pasta)</h2>
  <input type="file" webkitdirectory multiple id="folderInput">
</div>

<div class="box">
  <h2>Importar Texturas Avulsas (.png)</h2>
  <input type="file" multiple accept=".png" id="fileInput">
  <p style="font-size:13px">
    Pode importar várias vezes. Texturas repetidas ou com mesmo nome são ignoradas.
  </p>
</div>

<div class="box">
  <h2>Itens / Blocos</h2>
  <div id="items" class="grid"></div>
</div>

<div class="box">
  <h2>Preview</h2>
  <p id="previewName">Nenhum item selecionado</p>
</div>

<script>
const itemsDiv = document.getElementById('items');
const previewName = document.getElementById('previewName');

const items = {}; // chave = id do item
let selectedId = null;

function createItem(id, file) {
  if (items[id]) return; // não duplica

  const url = URL.createObjectURL(file);

  items[id] = {
    id,
    displayName: id.replace(/_/g,' '),
    file
  };

  const div = document.createElement('div');
  div.className = 'item';
  div.dataset.id = id;

  const img = document.createElement('img');
  img.src = url;

  const label = document.createElement('div');
  label.textContent = id;

  const input = document.createElement('input');
  input.value = items[id].displayName;
  input.placeholder = 'Nome do item no jogo';

  input.addEventListener('input', () => {
    items[id].displayName = input.value;
    if (selectedId === id) {
      previewName.textContent = input.value;
    }
  });

  div.addEventListener('click', () => {
    document.querySelectorAll('.item').forEach(i => i.classList.remove('selected'));
    div.classList.add('selected');
    selectedId = id;
    previewName.textContent = items[id].displayName;
  });

  div.appendChild(img);
  div.appendChild(label);
  div.appendChild(input);
  itemsDiv.appendChild(div);
}

/* IMPORTAR PASTA */
folderInput.addEventListener('change', (e) => {
  const files = [...e.target.files];

  const pngs = files.filter(f =>
    f.name.endsWith('.png') &&
    (f.webkitRelativePath.includes('/textures/block/') ||
     f.webkitRelativePath.includes('/textures/item/'))
  );

  for (const file of pngs) {
    const id = file.name.replace('.png','');
    createItem(id, file);
  }
});

/* IMPORTAR ARQUIVOS AVULSOS (MÚLTIPLOS / VÁRIAS VEZES) */
fileInput.addEventListener('change', (e) => {
  const files = [...e.target.files];

  for (const file of files) {
    const id = file.name.replace('.png','');
    createItem(id, file);
  }

  fileInput.value = ''; // permite importar de novo os mesmos arquivos depois
});
</script>

</body>
</html>
