<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerador Minecraft Resource Pack</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<style>
:root{
  --bg:#f8f8f8;
  --text:#222;
  --card:#e0e0e0;
  --item:#f0f0f0;
}
body{
  font-family:Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
  max-width:1200px;
  margin:auto;
  padding:20px;
}
h1{text-align:center}
.card{
  background:var(--card);
  padding:16px;
  border-radius:10px;
  margin-bottom:20px;
}
button{
  cursor:pointer;
  border:none;
  padding:6px 10px;
  border-radius:6px;
}
select,input,textarea{
  width:100%;
  margin:6px 0;
  padding:6px;
}
#itemsContainer{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
}
.item{
  background:var(--item);
  border-radius:8px;
  padding:10px;
  text-align:center;
}
.preview{
  width:100%;
  aspect-ratio:1/1;
  background:#ddd;
  border-radius:6px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  overflow:hidden;
  text-align:center;
  padding:4px;
}
.preview img{
  max-width:100%;
  max-height:100%;
}
.menu-config{
  position:fixed;
  top:20px;
  left:0;
  background:#ddd;
  padding:12px;
  border-radius:0 8px 8px 0;
}
.small{font-size:12px;opacity:.7}
</style>
</head>

<body>

<h1>Gerador Minecraft Resource Pack</h1>

<div class="menu-config">
  Fonte
  <input type="number" value="16" onchange="document.body.style.fontSize=this.value+'px'">
</div>

<div class="card">
  <b>Modo Resource Pack</b><br>
  <span class="small">Substitua terracotas e blocos</span>
</div>

<div class="card">
  <label>Nome do projeto</label>
  <input id="projectName">
  <label>Descrição</label>
  <textarea id="projectDesc"></textarea>
</div>

<div class="card">
  <h3>Adicionar blocos</h3>
  <select id="blockSelector"></select>
  <button onclick="addVanillaBlock()">Adicionar bloco</button>

  <hr>

  <label><b>Importar Resource Pack (PASTA)</b></label>
  <input type="file" webkitdirectory multiple onchange="importResourcePack(this.files)">
</div>

<div class="card">
  <h3>Blocos configurados</h3>
  <div id="itemsContainer"></div>
</div>

<button onclick="exportPack()">Exportar</button>

<script>
const vanillaBlocks=[
  "white_terracotta","orange_terracotta","magenta_terracotta",
  "light_blue_terracotta","yellow_terracotta","lime_terracotta",
  "pink_terracotta","gray_terracotta","light_gray_terracotta",
  "cyan_terracotta","purple_terracotta","blue_terracotta",
  "brown_terracotta","green_terracotta","red_terracotta",
  "black_terracotta","terracotta","bricks","stone_bricks"
];

let available=[...vanillaBlocks];
let blocks={};
let langData={};

function prettify(id){
  return id.replace(/_/g," ").replace(/\b\w/g,l=>l.toUpperCase());
}

function refreshSelector(){
  const s=document.getElementById("blockSelector");
  s.innerHTML="";
  available.forEach(b=>{
    const o=document.createElement("option");
    o.value=b;o.textContent=b;
    s.appendChild(o);
  });
}

function addVanillaBlock(){
  const id=document.getElementById("blockSelector").value;
  blocks[id]={
    id,
    texture:null,
    displayName:langData["block.minecraft."+id] || prettify(id)
  };
  available=available.filter(b=>b!==id);
  refreshSelector();
  render();
}

async function readLang(files){
  const langFile=[...files].find(f =>
    f.webkitRelativePath.endsWith("/lang/pt_br.json") ||
    f.webkitRelativePath.endsWith("/lang/en_us.json")
  );
  if(!langFile) return;
  const text=await langFile.text();
  try{ langData=JSON.parse(text); }catch{}
}

async function importResourcePack(files){
  await readLang(files);

  [...files].forEach(file=>{
    const path=file.webkitRelativePath.replace(/\\/g,"/");
    if(!path.includes("assets/minecraft/textures")) return;
    if(!file.name.endsWith(".png")) return;

    const id=file.name.replace(".png","");
    const reader=new FileReader();
    reader.onload=()=>{
      blocks[id]={
        id,
        texture:reader.result,
        displayName:langData["block.minecraft."+id] || prettify(id)
      };
      available=available.filter(b=>b!==id);
      refreshSelector();
      render();
    };
    reader.readAsDataURL(file);
  });
}

function render(){
  const c=document.getElementById("itemsContainer");
  c.innerHTML="";
  Object.values(blocks).forEach(b=>{
    const d=document.createElement("div");
    d.className="item";
    d.innerHTML=`
      <div class="preview">
        ${b.texture ? `<img src="${b.texture}">` : b.displayName}
      </div>
      <b>${b.id}</b><br>
      <input value="${b.displayName}" placeholder="Nome no jogo"
        oninput="blocks['${b.id}'].displayName=this.value">
      <input type="file" accept="image/png" onchange="setTexture('${b.id}',this.files[0])">
      ${b.texture?`<button onclick="downloadTexture('${b.id}')">Baixar textura</button>`:""}
      <button onclick="removeBlock('${b.id}')">Remover</button>
    `;
    c.appendChild(d);
  });
}

function setTexture(id,file){
  const r=new FileReader();
  r.onload=()=>{blocks[id].texture=r.result;render();}
  r.readAsDataURL(file);
}

function downloadTexture(id){
  const a=document.createElement("a");
  a.href=blocks[id].texture;
  a.download=id+".png";
  a.click();
}

function removeBlock(id){
  delete blocks[id];
  if(vanillaBlocks.includes(id)) available.push(id);
  refreshSelector();
  render();
}

async function exportPack(){
  const zip=new JSZip();
  const rp=zip.folder("resourcepack");
  rp.file("pack.mcmeta",JSON.stringify({
    pack:{pack_format:15,description:document.getElementById("projectDesc").value||"Resource Pack"}
  },null,2));

  const tex=rp.folder("assets/minecraft/textures/block");
  const lang=rp.folder("assets/minecraft/lang");
  const langObj={};

  for(const b of Object.values(blocks)){
    if(b.texture){
      const bin=await fetch(b.texture).then(r=>r.arrayBuffer());
      tex.file(b.id+".png",bin);
    }
    langObj["block.minecraft."+b.id]=b.displayName;
  }

  lang.file("pt_br.json",JSON.stringify(langObj,null,2));

  const blob=await zip.generateAsync({type:"blob"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="resourcepack.zip";
  a.click();
}

refreshSelector();
</script>

</body>
</html>
